<div class="container container-page">
  <div class="nav">
    <h1>{{isCreating ? 'Crear nueva categoría' : 'Editar Categoría'}}</h1>
  </div>

    <form [formGroup]="categoriaForm" (ngSubmit)="onSubmit()" *ngIf="!isLoading && (isCreating || (categoria && categoria.id))">
      <div class="campo">
        <label for="title">Nombre de la Categoría</label>
        <input
          type="text"
          id="title"
          formControlName="title"
          class="form-control"
          [class.is-invalid]="titleControl?.invalid && titleControl?.touched"
          placeholder="Ingrese el nombre de la categoría">

        <div class="error-message" *ngIf="titleControl?.invalid && titleControl?.touched">
          <span *ngIf="titleControl?.errors?.['required']">El nombre de la categoría es requerido</span>
          <span *ngIf="titleControl?.errors?.['minlength']">El nombre debe tener al menos 2 caracteres</span>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn-base btn-cancel" (click)="cancelar()">
          <span class="material-symbols-outlined">cancel</span>
          Cancelar
        </button>
        <button type="button" class="btn-base btn-delete" (click)="confirmarEliminacion()" [disabled]="isLoading" *ngIf="!isCreating">
          <span class="material-symbols-outlined">delete</span>
          Eliminar
        </button>
        <button type="submit" class="btn-base btn-save" [disabled]="categoriaForm.invalid || isLoading || (!isCreating && !categoria)">
          <span class="material-symbols-outlined" *ngIf="!isLoading">{{isCreating ? 'add' : 'save'}}</span>
          <span class="loading-spinner" *ngIf="isLoading"></span>
          {{ isLoading ? (isCreating ? 'Creando...' : 'Guardando...') : (isCreating ? 'Crear Categoría' : 'Guardar') }}
        </button>
      </div>
    </form>

  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner"></div>
    <p>Cargando categoría...</p>
  </div>

  <div class="error-container" *ngIf="!isLoading && (!isCreating && !categoria)">
    <p>No se pudo cargar la categoría</p>
    <button class="btn-base btn-cancel" (click)="cancelar()">Volver</button>
  </div>
</div>
